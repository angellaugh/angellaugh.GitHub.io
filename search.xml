<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>ES</title>
    <url>/2023/02/11/ES/</url>
    <content><![CDATA[<p>sudo zypper refresh<br>sudo zypper update -y<br>sudo zypper install yum</p>
<h3 id="Import-the-Elasticsearch-GPG-Key"><a href="#Import-the-Elasticsearch-GPG-Key" class="headerlink" title="Import the Elasticsearch GPG Key"></a>Import the Elasticsearch GPG Key</h3><p><code>sudo rpm --import https://artifacts.elastic.co/GPG-KEY-elasticsearch</code></p>
<h3 id="Install-Elasticsearch-from-the-RPM-repository"><a href="#Install-Elasticsearch-from-the-RPM-repository" class="headerlink" title="Install Elasticsearch from the RPM repository"></a>Install Elasticsearch from the RPM repository</h3><p>create elasticsearch.repo and config the es install repo</p>
<p><code>sudo vim /etc/zypp/repos.d/elasticsearch.repo</code></p>
<span id="more"></span>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[elasticsearch]</span><br><span class="line">name=Elasticsearch repository for 8.x packages</span><br><span class="line">baseurl=https://artifacts.elastic.co/packages/8.x/yum</span><br><span class="line">gpgcheck=1</span><br><span class="line">gpgkey=https://artifacts.elastic.co/GPG-KEY-elasticsearch</span><br><span class="line">enabled=0</span><br><span class="line">autorefresh=1</span><br><span class="line">type=rpm-md</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>install ES</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo zypper modifyrepo --enable elasticsearch &amp;&amp; \</span><br><span class="line">  sudo zypper install elasticsearch; \</span><br><span class="line">  sudo zypper modifyrepo --disable elasticsearch </span><br></pre></td></tr></table></figure>

<p>download and install RPM </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-8.5.2-x86_64.rpm</span><br><span class="line">wget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-8.5.2-x86_64.rpm.sha512</span><br><span class="line">shasum -a 512 -c elasticsearch-8.5.2-x86_64.rpm.sha512 </span><br><span class="line">sudo rpm --install elasticsearch-8.5.2-x86_64.rpm</span><br></pre></td></tr></table></figure>

<p>config the es start automatically when system boots up</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ES-suse:/etc/zypp/repos.d # sudo /bin/systemctl daemon-reload</span><br><span class="line">ES-suse:/etc/zypp/repos.d # sudo /bin/systemctl enable elasticsearch.service</span><br><span class="line">Created symlink /etc/systemd/system/multi-user.target.wants/elasticsearch.service â†’ /usr/lib/systemd/system/elasticsearch.service.</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>check the ES</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ES-suse:/etc/zypp/repos.d # rpm -qi elasticsearch</span><br><span class="line">Name        : elasticsearch</span><br><span class="line">Epoch       : 0</span><br><span class="line">Version     : 7.17.7</span><br><span class="line">Release     : 1</span><br><span class="line">Architecture: x86_64</span><br><span class="line">Install Date: Sun Dec  4 21:37:47 2022</span><br><span class="line">Group       : Application/Internet</span><br><span class="line">Size        : 525810397</span><br><span class="line">License     : Elastic License</span><br><span class="line">Signature   : RSA/SHA512, Mon Oct 17 14:57:09 2022, Key ID d27d666cd88e42b4</span><br><span class="line">Source RPM  : elasticsearch-7.17.7-1-src.rpm</span><br><span class="line">Build Date  : Mon Oct 17 11:35:59 2022</span><br><span class="line">Build Host  : packer-virtualbox-iso-1646848364</span><br><span class="line">Relocations : /usr</span><br><span class="line">Packager    : Elasticsearch</span><br><span class="line">Vendor      : Elasticsearch</span><br><span class="line">URL         : https://www.elastic.co/</span><br><span class="line">Summary     : Distributed RESTful search engine built for the cloud</span><br><span class="line">Description :</span><br><span class="line">Reference documentation can be found at</span><br><span class="line">  https://www.elastic.co/guide/en/elasticsearch/reference/current/index.html</span><br><span class="line">  and the &#x27;Elasticsearch: The Definitive Guide&#x27; book can be found at</span><br><span class="line">  https://www.elastic.co/guide/en/elasticsearch/guide/current/index.html</span><br><span class="line">Distribution: Elasticsearch</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>start es server</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ES-suse:/etc/zypp/repos.d # sudo systemctl start elasticsearch</span><br><span class="line">ES-suse:/etc/zypp/repos.d # sudo systemctl status elasticsearch</span><br><span class="line">â— elasticsearch.service - Elasticsearch</span><br><span class="line">     Loaded: loaded (/usr/lib/systemd/system/elasticsearch.service; disabled; vendor preset: disabled)</span><br><span class="line">     Active: active (running) since Sun 2022-12-04 21:39:35 EST; 21s ago</span><br><span class="line">       Docs: https://www.elastic.co</span><br><span class="line">   Main PID: 8555 (java)</span><br><span class="line">      Tasks: 97 (limit: 4915)</span><br><span class="line">     CGroup: /system.slice/elasticsearch.service</span><br><span class="line">             â”œâ”€ 8555 /usr/share/elasticsearch/jdk/bin/java -Xshare:auto -Des.networkaddress.cache.ttl=60 -Des.networkaddress.cache.negative.ttl=10 -XX:+Always&gt;</span><br><span class="line">             â””â”€ 8767 /usr/share/elasticsearch/modules/x-pack-ml/platform/linux-x86_64/bin/controller</span><br><span class="line"></span><br><span class="line">Dec 04 21:39:17 ES-suse systemd[1]: Starting Elasticsearch...</span><br><span class="line">Dec 04 21:39:35 ES-suse systemd[1]: Started Elasticsearch.</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>related log:<br><code> vi /var/log/elasticsearch/elasticsearch.log</code></p>
<p>datapath<br><code>/var/lib/elasticsearch</code></p>
<p>To list journal entries for the elasticsearch service:</p>
<p><code>sudo journalctl --unit elasticsearch</code></p>
<p>verify es installation</p>
<ol>
<li><code>ss -antpl | grep 9200</code></li>
<li><code>curl -X GET &quot;localhost:9200/&quot;</code></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ES-suse:/etc/zypp/repos.d # ss -antpl | grep 9200</span><br><span class="line">LISTEN 0      4096   [::ffff:127.0.0.1]:9200             *:*    users:((&quot;java&quot;,pid=8555,fd=305))</span><br><span class="line">LISTEN 0      4096                [::1]:9200          [::]:*    users:((&quot;java&quot;,pid=8555,fd=304))</span><br><span class="line">ES-suse:/etc/zypp/repos.d # curl -X GET &quot;localhost:9200/&quot;</span><br><span class="line">&#123;</span><br><span class="line">  &quot;name&quot; : &quot;ES-suse&quot;,</span><br><span class="line">  &quot;cluster_name&quot; : &quot;elasticsearch&quot;,</span><br><span class="line">  &quot;cluster_uuid&quot; : &quot;0zL15OxVTY6SrXO2aQ6qGQ&quot;,</span><br><span class="line">  &quot;version&quot; : &#123;</span><br><span class="line">    &quot;number&quot; : &quot;7.17.7&quot;,</span><br><span class="line">    &quot;build_flavor&quot; : &quot;default&quot;,</span><br><span class="line">    &quot;build_type&quot; : &quot;rpm&quot;,</span><br><span class="line">    &quot;build_hash&quot; : &quot;78dcaaa8cee33438b91eca7f5c7f56a70fec9e80&quot;,</span><br><span class="line">    &quot;build_date&quot; : &quot;2022-10-17T15:29:54.167373105Z&quot;,</span><br><span class="line">    &quot;build_snapshot&quot; : false,</span><br><span class="line">    &quot;lucene_version&quot; : &quot;8.11.1&quot;,</span><br><span class="line">    &quot;minimum_wire_compatibility_version&quot; : &quot;6.8.0&quot;,</span><br><span class="line">    &quot;minimum_index_compatibility_version&quot; : &quot;6.0.0-beta1&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;tagline&quot; : &quot;You Know, for Search&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>input one data:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">curl -H &#x27;Content-Type: application/json&#x27; -X POST &#x27;http://localhost:9200/todo/task/1&#x27; -d &#x27;&#123; &quot;name&quot;: &quot;Go to the mall.&quot; &#125;&#x27;</span><br></pre></td></tr></table></figure>
<p>and read it again:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ES-suse:/etc/zypp/repos.d # curl -X GET &#x27;http://localhost:9200/todo/task/1?pretty&#x27;</span><br><span class="line">&#123;</span><br><span class="line">  &quot;_index&quot; : &quot;todo&quot;,</span><br><span class="line">  &quot;_type&quot; : &quot;task&quot;,</span><br><span class="line">  &quot;_id&quot; : &quot;1&quot;,</span><br><span class="line">  &quot;_version&quot; : 1,</span><br><span class="line">  &quot;_seq_no&quot; : 0,</span><br><span class="line">  &quot;_primary_term&quot; : 1,</span><br><span class="line">  &quot;found&quot; : true,</span><br><span class="line">  &quot;_source&quot; : &#123;</span><br><span class="line">    &quot;name&quot; : &quot;Go to the mall.&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>










<p> curl -XGET â€˜<a href="http://localhost:9200/_nodes/stats?pretty&#39;">http://localhost:9200/_nodes/stats?pretty&#39;</a> | grep thread</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#125;ES-suse:/etc/zypp/repos.d #  curl -XGET &#x27;http://localhost:9200/_nodes/stats?pretty&#x27; | grep thread</span><br><span class="line">  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span><br><span class="line">                                 Dload  Upload   Total   Spent    Left  Speed</span><br><span class="line">100 39463  100 39463    0     0  1144k      0 --:--:-- --:--:--        &quot;threads&quot; : &#123;</span><br><span class="line"> --:--:--      &quot;thread_pool&quot; : &#123;</span><br><span class="line"> 1          &quot;threads&quot; : 0,</span><br><span class="line">16          &quot;threads&quot; : 0,</span><br><span class="line">7          &quot;threads&quot; : 0,</span><br><span class="line">k          &quot;threads&quot; : 0,</span><br><span class="line"></span><br><span class="line">          &quot;threads&quot; : 0,</span><br><span class="line">          &quot;threads&quot; : 1,</span><br><span class="line">          &quot;threads&quot; : 0,</span><br><span class="line">          &quot;threads&quot; : 11,</span><br><span class="line">          &quot;threads&quot; : 2,</span><br><span class="line">          &quot;threads&quot; : 0,</span><br><span class="line">          &quot;threads&quot; : 2,</span><br><span class="line">          &quot;threads&quot; : 0,</span><br><span class="line">          &quot;threads&quot; : 0,</span><br><span class="line">          &quot;threads&quot; : 1,</span><br><span class="line">          &quot;threads&quot; : 3,</span><br><span class="line">          &quot;threads&quot; : 0,</span><br><span class="line">          &quot;threads&quot; : 0,</span><br><span class="line">          &quot;threads&quot; : 0,</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">ES-suse:/etc # ll /usr/share/elasticsearch/bin</span><br><span class="line">total 3028</span><br><span class="line">-rwxr-xr-x 1 root root     101 Nov 17 14:04 elasticsearch</span><br><span class="line">-rwxr-xr-x 1 root root     376 Nov 17 13:59 elasticsearch-certgen</span><br><span class="line">-rwxr-xr-x 1 root root     376 Nov 17 13:59 elasticsearch-certutil</span><br><span class="line">-rwxr-xr-x 1 root root     674 Nov 17 14:04 elasticsearch-cli</span><br><span class="line">-rwxr-xr-x 1 root root     353 Nov 17 13:59 elasticsearch-create-enrollment-token</span><br><span class="line">-rwxr-xr-x 1 root root     352 Nov 17 13:59 elasticsearch-croneval</span><br><span class="line">-rwxr-xr-x 1 root root    2340 Nov 17 14:04 elasticsearch-env</span><br><span class="line">-rwxr-xr-x 1 root root    2595 Nov 17 14:04 elasticsearch-env-from-file</span><br><span class="line">-rwxr-xr-x 1 root root      84 Nov 17 14:04 elasticsearch-geoip</span><br><span class="line">-rwxr-xr-x 1 root root      87 Nov 17 14:04 elasticsearch-keystore</span><br><span class="line">-rwxr-xr-x 1 root root      55 Nov 17 14:04 elasticsearch-node</span><br><span class="line">-rwxr-xr-x 1 root root     172 Nov 17 14:04 elasticsearch-plugin</span><br><span class="line">-rwxr-xr-x 1 root root     376 Nov 17 13:59 elasticsearch-reconfigure-node</span><br><span class="line">-rwxr-xr-x 1 root root     353 Nov 17 13:59 elasticsearch-reset-password</span><br><span class="line">-rwxr-xr-x 1 root root     353 Nov 17 13:59 elasticsearch-saml-metadata</span><br><span class="line">-rwxr-xr-x 1 root root     353 Nov 17 13:59 elasticsearch-service-tokens</span><br><span class="line">-rwxr-xr-x 1 root root     353 Nov 17 13:59 elasticsearch-setup-passwords</span><br><span class="line">-rwxr-xr-x 1 root root      55 Nov 17 14:04 elasticsearch-shard</span><br><span class="line">-rwxr-xr-x 1 root root     403 Nov 17 13:59 elasticsearch-sql-cli</span><br><span class="line">-rwxr-xr-x 1 root root 3008975 Nov 17 13:59 elasticsearch-sql-cli-8.5.2.jar</span><br><span class="line">-rwxr-xr-x 1 root root     353 Nov 17 13:59 elasticsearch-syskeygen</span><br><span class="line">-rwxr-xr-x 1 root root     353 Nov 17 13:59 elasticsearch-users</span><br><span class="line">-rwxr-xr-x 1 root root     332 Nov 17 14:01 systemd-entrypoint</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h3 id="health-check"><a href="#health-check" class="headerlink" title="health check"></a>health check</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">curl &#x27;localhost:9200/_cat/health?v&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="nodes-list"><a href="#nodes-list" class="headerlink" title="nodes list"></a>nodes list</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">curl &#x27;localhost:9200/_cat/nodes?v&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="index-list"><a href="#index-list" class="headerlink" title="index list"></a>index list</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">curl &#x27;localhost:9200/_cat/indices?v&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="search-detail-data-using-index"><a href="#search-detail-data-using-index" class="headerlink" title="search detail data using index"></a>search detail data using index</h3><p><code>curl -X GET http://localhost:9200/je_index_1663720218/</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">root@powerload-es-2:~ # curl -X GET http://localhost:9200/je_index_1663720218/_search?pretty</span><br><span class="line">&#123;</span><br><span class="line">  &quot;took&quot; : 7,</span><br><span class="line">  &quot;timed_out&quot; : false,</span><br><span class="line">  &quot;_shards&quot; : &#123;</span><br><span class="line">    &quot;total&quot; : 5,</span><br><span class="line">    &quot;successful&quot; : 5,</span><br><span class="line">    &quot;skipped&quot; : 0,</span><br><span class="line">    &quot;failed&quot; : 0</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;hits&quot; : &#123;</span><br><span class="line">    &quot;total&quot; : 0,</span><br><span class="line">    &quot;max_score&quot; : null,</span><br><span class="line">    &quot;hits&quot; : [ ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="æŸ¥çœ‹é›†ç¾¤å…¨éƒ¨èŠ‚ç‚¹çš„æŒ‡æ ‡"><a href="#æŸ¥çœ‹é›†ç¾¤å…¨éƒ¨èŠ‚ç‚¹çš„æŒ‡æ ‡" class="headerlink" title="æŸ¥çœ‹é›†ç¾¤å…¨éƒ¨èŠ‚ç‚¹çš„æŒ‡æ ‡"></a>æŸ¥çœ‹é›†ç¾¤å…¨éƒ¨èŠ‚ç‚¹çš„æŒ‡æ ‡</h1><p>$ curl â€œlocalhost:9200/_nodes/statsâ€</p>
<hr>
<p>Issue1</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ES-suse:/etc/zypp/repos.d # sudo systemctl enable elasticsearch</span><br><span class="line">Synchronizing state of elasticsearch.service with SysV service script with /usr/lib/systemd/systemd-sysv-install.</span><br><span class="line">Executing: /usr/lib/systemd/systemd-sysv-install enable elasticsearch</span><br><span class="line">ln -sf ../elasticsearch /etc/init.d/rc2.d/S50elasticsearch</span><br><span class="line">ln: failed to create symbolic link &#x27;/etc/init.d/rc2.d/S50elasticsearch&#x27;: No such file or directory</span><br></pre></td></tr></table></figure>

<p>It seems that this product is not from the standard openSUSE OSS repo.</p>
<p>It tries to use /etc/init.d/rc2.d which directory belongs to the old SystemV ways of doing (as the message also says). but in openSUSE that directory is no longer in use and most probably not available anymore.</p>
<p>Issue2: refusedäº†</p>
<p>root@ldm-controller-01:/usr/local/stress_test/Island_TPPC # curl -X GET â€œ<a href="http://10.219.61.175:9200/_cat/indices?v&quot;">http://10.219.61.175:9200/_cat/indices?v&quot;</a><br>curl: (7) Failed connect to 10.219.61.175:9200; Connection refused</p>
<p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”Dry run es-opensuse on powerloadâ€”â€”â€”â€”â€”â€”â€”â€”<br>Config ES-suse to powerload json file</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">root@ldm-controller-01:/usr/local/stress_test/Island_TPPC # nslookup ES-suse.west.isilon.com</span><br><span class="line">Server:         10.231.252.14</span><br><span class="line">Address:        10.231.252.14#53</span><br><span class="line"></span><br><span class="line">Non-authoritative answer:</span><br><span class="line">Name:   ES-suse.west.isilon.com</span><br><span class="line">Address: 10.219.61.175</span><br></pre></td></tr></table></figure>

<p>![](vx_images/65815239672.png =800x)</p>
<h3 id="cat-methods"><a href="#cat-methods" class="headerlink" title="cat methods"></a>cat methods</h3><p><code>curl http://localhost:9200/_cat</code></p>
<p>ES-suse:/var/lib/elasticsearch #  curl <a href="http://localhost:9200/_cat">http://localhost:9200/_cat</a><br>=^.^=<br>/_cat/allocation<br>/_cat/shards<br>/_cat/shards/{index}<br>/_cat/master<br>/_cat/nodes<br>/_cat/tasks<br>/_cat/indices<br>/_cat/indices/{index}<br>/_cat/segments<br>/_cat/segments/{index}<br>/_cat/count<br>/_cat/count/{index}<br>/_cat/recovery<br>/_cat/recovery/{index}<br>/_cat/health<br>/_cat/pending_tasks<br>/_cat/aliases<br>/_cat/aliases/{alias}<br>/_cat/thread_pool<br>/_cat/thread_pool/{thread_pools}<br>/_cat/plugins<br>/_cat/fielddata<br>/_cat/fielddata/{fields}<br>/_cat/nodeattrs<br>/_cat/repositories<br>/_cat/snapshots/{repository}<br>/_cat/templates<br>/_cat/ml/anomaly_detectors<br>/_cat/ml/anomaly_detectors/{job_id}<br>/_cat/ml/trained_models<br>/_cat/ml/trained_models/{model_id}<br>/_cat/ml/datafeeds<br>/_cat/ml/datafeeds/{datafeed_id}<br>/_cat/ml/data_frame/analytics<br>/_cat/ml/data_frame/analytics/{id}<br>/_cat/transforms<br>/_cat/transforms/{transform_id}</p>
<p><a href="https://juejin.cn/post/7145773678649671694">https://juejin.cn/post/7145773678649671694</a></p>
<p>curl localhost:9200/_cat/nodes?help</p>
<h1 id="æŒ‡å®šæŸ¥çœ‹æ¯ä¸ªèŠ‚ç‚¹çš„å †å†…å­˜ä½¿ç”¨ç‡ï¼Œæ®µæ•°é‡å’Œåˆå¹¶æ•°é‡"><a href="#æŒ‡å®šæŸ¥çœ‹æ¯ä¸ªèŠ‚ç‚¹çš„å †å†…å­˜ä½¿ç”¨ç‡ï¼Œæ®µæ•°é‡å’Œåˆå¹¶æ•°é‡" class="headerlink" title="æŒ‡å®šæŸ¥çœ‹æ¯ä¸ªèŠ‚ç‚¹çš„å †å†…å­˜ä½¿ç”¨ç‡ï¼Œæ®µæ•°é‡å’Œåˆå¹¶æ•°é‡"></a>æŒ‡å®šæŸ¥çœ‹æ¯ä¸ªèŠ‚ç‚¹çš„å †å†…å­˜ä½¿ç”¨ç‡ï¼Œæ®µæ•°é‡å’Œåˆå¹¶æ•°é‡</h1><p>$ curl â€œ<a href="http://localhost:9200/_cat/nodes?h=http,heapPercent,segmentsCount,mergesTotal&quot;">http://localhost:9200/_cat/nodes?h=http,heapPercent,segmentsCount,mergesTotal&quot;</a><br>172.16.71.231:9200 56 99 108182<br>172.16.71.229:9200 31 95 122551<br>172.16.71.232:9200 50 66  73871<br>172.16.71.230:9200 41 63  76470<br>172.16.71.234:9200 32 64  93256<br>172.16.71.233:9200 14 90 136450</p>
<p>å½“é›†ç¾¤ä¸ºredæˆ–è€…yellowçš„æ—¶å€™æ€ä¹ˆåŠ<br>é›†ç¾¤ä¸ºREDè¡¨ç¤ºé›†ç¾¤ä¸­æœ‰primary shardæ²¡æœ‰åˆ†é…ï¼Œyellowè¡¨ç¤ºæœ‰replicaæ²¡æœ‰åˆ†é…</p>
<p>root@powerload-es-2:/var/lib/elasticsearch/nodes # curl -X GET â€œ<a href="http://localhost:9200/_cluster/allocation/explain?pretty&quot;">http://localhost:9200/_cluster/allocation/explain?pretty&quot;</a><br>{<br>  â€œindexâ€ : â€œje_index_1664986024â€,<br>  â€œshardâ€ : 3,<br>  â€œprimaryâ€ : false,<br>  â€œcurrent_stateâ€ : â€œunassignedâ€,<br>  â€œunassigned_infoâ€ : {<br>    â€œreasonâ€ : â€œCLUSTER_RECOVEREDâ€,<br>    â€œatâ€ : â€œ2022-12-05T02:18:25.712Zâ€,<br>    â€œlast_allocation_statusâ€ : â€œno_attemptâ€<br>  },<br>  â€œcan_allocateâ€ : â€œnoâ€,<br>  â€œallocate_explanationâ€ : â€œcannot allocate because allocation is not permitted to any of the nodesâ€,<br>  â€œnode_allocation_decisionsâ€ : [<br>    {<br>      â€œnode_idâ€ : â€œR2DFntg7RLiwYsEN4mwYuwâ€,<br>      â€œnode_nameâ€ : â€œR2DFntgâ€,<br>      â€œtransport_addressâ€ : â€œ10.219.61.247:9300â€,<br>      â€œnode_attributesâ€ : {<br>        â€œml.machine_memoryâ€ : â€œ16656269312â€,<br>        â€œxpack.installedâ€ : â€œtrueâ€,<br>        â€œml.max_open_jobsâ€ : â€œ20â€,<br>        â€œml.enabledâ€ : â€œtrueâ€<br>      },<br>      â€œnode_decisionâ€ : â€œnoâ€,<br>      â€œdecidersâ€ : [<br>        {<br>          â€œdeciderâ€ : â€œsame_shardâ€,<br>          â€œdecisionâ€ : â€œNOâ€,<br>          â€œexplanationâ€ : â€œthe shard cannot be allocated to the same node on which a copy of the shard already exists [[je_index_1664986024][3], node[R2DFntg7RLiwYsEN4mwYuw], [P], s[STARTED], a[id=488Lf_8lTI2raran4YNWoQ]]â€<br>        }<br>      ]<br>    }<br>  ]<br>}</p>
<p>åˆ†ç‰‡é•¿æ—¶é—´å¤„äºæœªåˆ†é…çŠ¶æ€ ESå†…éƒ¨ä¼šå¯¹ä¸€ä¸ªunassigned åˆ†ç‰‡å°è¯•5æ¬¡è¿›è¡Œåˆ†é…,å¤±è´¥åä¸å†å°è¯•è¿›è¡Œåˆ†é…ï¼Œè¿™æ—¶å€™éœ€è¦è°ƒç”¨è¿›è¡Œæ‰‹åŠ¨æ§åˆ¶é›†ç¾¤å¤„ç† unassigned åˆ†ç‰‡ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Before starting Elasticsearch for the first time</span><br><span class="line">Set xpack.security.enabled: false and then start Elasticsearch</span><br><span class="line"></span><br><span class="line">After you have started Elasticsearch for the first time</span><br><span class="line">You have two options here</span><br><span class="line"></span><br><span class="line">Set</span><br><span class="line"></span><br><span class="line">xpack.security.enabled: false</span><br><span class="line">xpack.security.transport.ssl.enabled: false</span><br><span class="line">xpack.security.http.ssl.enabled: false</span><br><span class="line">and then start Elasticsearch.</span><br><span class="line"></span><br><span class="line">Run</span><br><span class="line"></span><br><span class="line">bin/elasticsearch-keystore remove xpack.security.transport.ssl.keystore.secure_password</span><br><span class="line">bin/elasticsearch-keystore remove xpack.security.transport.ssl.truststore.secure_password</span><br><span class="line">bin/elasticsearch-keystore remove xpack.security.http.ssl.keystore.secure_password</span><br><span class="line">Set</span><br><span class="line"></span><br><span class="line">xpack.security.enabled: false</span><br></pre></td></tr></table></figure>


<h3 id="change-timezone"><a href="#change-timezone" class="headerlink" title="change timezone"></a>change timezone</h3><p>step1: vi /etc/sysconfig/clock</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">DEFAULT_TIMEZONE=&quot;Etc/GMT&quot;</span><br><span class="line">ZONE=&quot;Etc/GMT&quot;</span><br><span class="line">~</span><br><span class="line">```  </span><br><span class="line">step2: zic -l Etc/GMT</span><br><span class="line">step3: date</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>ES-suse:/var/log/elasticsearch # date<br>Tue Dec  6 03:46:47 EST 2022<br>ES-suse:/var/log/elasticsearch # vi /etc/sysconfig/clock<br>ES-suse:/var/log/elasticsearch # zic -l Etc/GMT<br>ES-suse:/var/log/elasticsearch # date<br>Tue Dec  6 08:55:46 GMT 2022</p>
<pre><code>
</code></pre>
]]></content>
      <categories>
        <category>Teckknowledge</category>
      </categories>
      <tags>
        <tag>ES</tag>
      </tags>
  </entry>
  <entry>
    <title>diango</title>
    <url>/2023/02/11/django/</url>
    <content><![CDATA[<h1 id="1-django"><a href="#1-django" class="headerlink" title="1. django"></a>1. django</h1><ol>
<li><p>pip3.8 install djangon</p>
</li>
<li><p>python3.8 -m django â€“version</p>
</li>
<li><p>django-admin</p>
</li>
<li><p>django-admin startproject  <del>myprojectname</del>  Multicorn_project  | on desktop</p>
</li>
<li><p>cd <del>myprojectname</del> Multicorn_project</p>
</li>
<li><p>tree<br>![](_v_images/20201001165628417_1726437634.png =200x)</p>
</li>
<li><p>python manage.py runserver</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">October 01, 2020 - 08:57:22</span><br><span class="line">Django version 3.1.2, using settings &#x27;Multicorn_project.settings&#x27;</span><br><span class="line">Starting development server at http://127.0.0.1:8000/</span><br></pre></td></tr></table></figure></li>
<li><p>python manage.py runserver 9999   | grep ç«¯å£</p>
</li>
<li><p>python manage.py startapp <del>yourappname</del> mouticorn</p>
</li>
<li><p>dirs:   multicorn -&gt; templates -&gt; multicorn -&gt; 2 files: home.html  and multicornjson.html</p>
</li>
<li><p>in home.html,  just input â€œhtml + tabâ€</p>
</li>
<li><p>look at the apps.py in the multicorn app </p>
</li>
<li><p>in project settings.py,  add multicorn.apps.MulticornConfig into the top of â€˜INSTALLED_APPSâ€™<br>![](_v_images/20201003160503076_808966192.png =320x)</p>
</li>
<li><p>dirs: multicorn -&gt; static -&gt; multicorn   </p>
<span id="more"></span></li>
<li><p>python manage.py makemigrations</p>
</li>
<li><p>python manage.py migrate</p>
</li>
<li></li>
<li><p> python manage.py createsuperuser  åˆ›å»ºä¸€ä¸ª admin user<br>username: ali1<br>password: lantian<br>email: <a href="mailto:&#x61;&#x6e;&#110;&#x69;&#101;&#46;&#x6c;&#105;&#49;&#64;&#x64;&#x65;&#108;&#x6c;&#x2e;&#x63;&#111;&#x6d;">&#x61;&#x6e;&#110;&#x69;&#101;&#46;&#x6c;&#105;&#49;&#64;&#x64;&#x65;&#108;&#x6c;&#x2e;&#x63;&#111;&#x6d;</a></p>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/Desktop/Multicorn_project ğŸ”¥Â» python manage.py createsuperuser                                                                      vivi@vivideMacBook-Pro</span><br><span class="line">Username (leave blank to use &#x27;vivi&#x27;): ali1</span><br><span class="line">Email address: annie.li1@dell.com</span><br><span class="line">Password:</span><br><span class="line">Password (again):</span><br><span class="line">This password is too short. It must contain at least 8 characters.</span><br><span class="line">Bypass password validation and create user anyway? [y/N]: y</span><br><span class="line">Superuser created successfully.</span><br></pre></td></tr></table></figure>

<blockquote>
<p><a href="https://getbootstrap.com/docs/4.5/getting-started/introduction/">ä¸€ä¸ªæœ‰ç”¨çš„cssç½‘ç«™</a><br>18.  åœ¨base.cssä¸­ï¼ŒæŠŠLoginçš„ href æ”¹æˆ <strong>href=â€/admin/â€œ</strong>, å³å¯ç™»å½•<br>![](_v_images/20201004152628847_575819787.png =520x)</p>
</blockquote>
<p>username: TestUser   password: django123</p>
<p>![](_v_images/20201004154036210_1241846727.png =220x)</p>
<ol start="19">
<li>models.py</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from django.db import models</span><br><span class="line">from django.utils import timezone</span><br><span class="line">from django.contrib.auth.models import User</span><br><span class="line"></span><br><span class="line">class Post(models.Model):</span><br><span class="line">    title = models.CharField(max_length=100)</span><br><span class="line">    content = models.TextField()</span><br><span class="line">    # auto_now, auto_now_add, default</span><br><span class="line">    date_posted = models.DateTimeField(default=timezone.now)</span><br><span class="line">    author = models.ForeignKey(User, on_delete=models.CASCADE)</span><br></pre></td></tr></table></figure>


<ol start="20">
<li>python manage.py makemigrations    muticorn -&gt; migrations -&gt; 0001_initial.py &amp; <strong>init</strong>.py<br>åœ¨ 0001_initial.pyä¸­æ˜¯ å»ºè¡¨è¯­å¥</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">~/Desktop/Multicorn_project ğŸ”¥Â» python manage.py makemigrations                                                                       vivi@vivideMacBook-Pro</span><br><span class="line">Migrations for &#x27;multicorn&#x27;:</span><br><span class="line">  multicorn/migrations/0001_initial.py</span><br><span class="line">    - Create model Post</span><br></pre></td></tr></table></figure>

<ol start="21">
<li> python manage.py sqlmigrate multicorn 0001_initial<br>æ‰§è¡Œå»ºè¡¨è¯­å¥å¹¶ä¸”commit åˆ°dbä¸­</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">~/Desktop/Multicorn_project ğŸ”¥Â» python manage.py sqlmigrate multicorn 0001_initial                                                    vivi@vivideMacBook-Pro</span><br><span class="line">BEGIN;</span><br><span class="line">--</span><br><span class="line">-- Create model Post</span><br><span class="line">--</span><br><span class="line">CREATE TABLE &quot;multicorn_post&quot; (&quot;id&quot; integer NOT NULL PRIMARY KEY AUTOINCREMENT, &quot;title&quot; varchar(100) NOT NULL, &quot;content&quot; text NOT NULL, &quot;date_posted&quot; datetime NOT NULL, &quot;author_id&quot; integer NOT NULL REFERENCES &quot;auth_user&quot; (&quot;id&quot;) DEFERRABLE INITIALLY DEFERRED);</span><br><span class="line">CREATE INDEX &quot;multicorn_post_author_id_82a8e3b2&quot; ON &quot;multicorn_post&quot; (&quot;author_id&quot;);</span><br><span class="line">COMMIT;</span><br></pre></td></tr></table></figure>
<ol start="22">
<li><p>python manage.py migrate</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">~/Desktop/Multicorn_project ğŸ”¥Â» python manage.py migrate                                   vivi@vivideMacBook-Pro</span><br><span class="line">Operations to perform:</span><br><span class="line">  Apply all migrations: admin, auth, contenttypes, multicorn, sessions</span><br><span class="line">Running migrations:</span><br><span class="line">  Applying multicorn.0001_initial... OK</span><br></pre></td></tr></table></figure></li>
<li><p>è¿›å…¥ django shell æ¨¡å¼</p>
</li>
<li><p>python manage.py shell</p>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> multicorn.models <span class="keyword">import</span> Post</span><br><span class="line"><span class="keyword">from</span> django.contrib.auth.models <span class="keyword">import</span> User</span><br><span class="line">User.objects.<span class="built_in">all</span>()</span><br><span class="line"></span><br><span class="line">&gt;&gt; &lt;QuerySet [&lt;User: ali1&gt;, &lt;User: TestUser&gt;]&gt;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥åœ¨shellæ¨¡å¼ä¸‹ï¼Œç­›é€‰<br>    1. User.objects.all()        â€“&gt;     &lt;QuerySet [&lt;User: ali1&gt;, &lt;User: TestUser&gt;]&gt;<br>    2. User.objects.first()         â€“&gt;           &lt;User: ali1&gt;<br>    3. User.objects.filter(username=â€™ali1â€™)            â€“&gt;               &lt;QuerySet [&lt;User: ali1&gt;]&gt;<br>    4. User.objects.filter(username=â€™ali1â€™).first()      â€“&gt;           &lt;User: ali1&gt;</p>
<p>å¯ä»¥ èµ‹å€¼ user åšå„ç§æ“ä½œï¼š<br>    1. user = User.objects.filter(username=â€™ali1â€™).first()<br>        ![](_v_images/20201004221441020_1148517328.png =300x)<br>    2. user.id<br>    3. user.pk<br>    4. user = User.objects.get(id=1)<br>    5. user   â€”&gt;   &lt;User: ali1&gt;<br>    ![](_v_images/20201004222758993_1547712460.png =200x)<br>ctrl + l  pythonä¸­çš„æ¸…å±</p>
<p>å¯ä»¥ç»™æ–°è¡¨ Post å¢åŠ æ•°æ®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>Post.objects.<span class="built_in">all</span>()</span><br><span class="line">&lt;QuerySet []&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>post_1 = Post(title=<span class="string">&#x27;blog 1&#x27;</span>, content=<span class="string">&#x27;First Post Content!&#x27;</span>, author=user)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>Post.objects.<span class="built_in">all</span>()</span><br><span class="line">&lt;QuerySet []&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>post_1.save()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>Post.objects.<span class="built_in">all</span>()</span><br><span class="line">&lt;QuerySet [&lt;Post: Post <span class="built_in">object</span> (<span class="number">1</span>)&gt;]&gt;</span><br></pre></td></tr></table></figure>
<ol start="25">
<li>å› ä¸ºæ‰“å°å‡ºæ¥çš„ Post.objects.all()  æ²¡æœ‰å±•ç¤ºtitle<br>è¿›å…¥ multicorn -&gt; models.py  åœ¨class Postä¸­æ·»åŠ <br>def <strong>str</strong>(self):<pre><code>return self.title
</code></pre>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Post</span>(models.Model):</span><br><span class="line">    title = models.CharField(max_length=<span class="number">100</span>)</span><br><span class="line">    content = models.TextField()</span><br><span class="line">    <span class="comment"># auto_now, auto_now_add, default</span></span><br><span class="line">    date_posted = models.DateTimeField(default=timezone.now)</span><br><span class="line">    author = models.ForeignKey(User, on_delete=models.CASCADE)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__str__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.title</span><br></pre></td></tr></table></figure>


<ol start="26">
<li><p>é‡æ–°æ‰“å¼€shellï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python manage.py shell</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> multicorn.models <span class="keyword">import</span> Post</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> django.contrib.auth.models <span class="keyword">import</span> User</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>Post.objects.<span class="built_in">all</span>()</span><br><span class="line">&lt;QuerySet [&lt;Post: blog <span class="number">1</span>&gt;]&gt;</span><br></pre></td></tr></table></figure></li>
<li><p>æ·»åŠ ç¬¬äºŒä¸ªblog,  æ³¨æ„<code>post_2.save()</code>, æ³¨æ„ <code>author_id = user.id</code></p>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>user = User.objects.<span class="built_in">filter</span>(username=<span class="string">&#x27;ali1&#x27;</span>).first()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>user</span><br><span class="line">&lt;User: ali1&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>post_2 = Post(title=<span class="string">&#x27;Blog 2&#x27;</span>, content=<span class="string">&#x27;Second Post Content!&#x27;</span>, author=user)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>post_2 = Post(title=<span class="string">&#x27;Blog 2&#x27;</span>, content=<span class="string">&#x27;Second Post Content!&#x27;</span>, author_id=user.<span class="built_in">id</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>post_2.save()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>Post.objects.<span class="built_in">all</span>()</span><br><span class="line">&lt;QuerySet [&lt;Post: blog <span class="number">1</span>&gt;, &lt;Post: Blog <span class="number">2</span>&gt;]&gt;</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<ol start="28">
<li>å¯ä»¥æŸ¥çœ‹postçš„å„ç§å±æ€§ï¼ŒåŒ…æ‹¬ <code>date_posted</code>,  å’Œ <code>å†…å»ºçš„user</code>, å’Œ <code>email</code><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>Post.objects.<span class="built_in">all</span>()</span><br><span class="line">&lt;QuerySet [&lt;Post: blog <span class="number">1</span>&gt;, &lt;Post: Blog <span class="number">2</span>&gt;]&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>post = Post.objects.first()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>post.content</span><br><span class="line"><span class="string">&#x27;First Post Content!&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>post.date_posted</span><br><span class="line">datetime.datetime(<span class="number">2020</span>, <span class="number">10</span>, <span class="number">4</span>, <span class="number">14</span>, <span class="number">30</span>, <span class="number">35</span>, <span class="number">354395</span>, tzinfo=&lt;UTC&gt;)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>post.author</span><br><span class="line">&lt;User: ali1&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>post.author.email</span><br><span class="line"><span class="string">&#x27;annie.li1@dell.com&#x27;</span></span><br></pre></td></tr></table></figure></li>
<li>å¯ä»¥æŸ¥çœ‹åŒä¸€ä¸ªuserçš„ æ‰€æœ‰ Post</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>user.post_set</span><br><span class="line">&lt;django.db.models.fields.related_descriptors.create_reverse_many_to_one_manager.&lt;<span class="built_in">locals</span>&gt;.RelatedManager <span class="built_in">object</span> at <span class="number">0x7ff829552640</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>user.post_set.<span class="built_in">all</span>()</span><br><span class="line">&lt;QuerySet [&lt;Post: blog <span class="number">1</span>&gt;, &lt;Post: Blog <span class="number">2</span>&gt;]&gt;</span><br></pre></td></tr></table></figure>
<ol start="30">
<li>å¯ä»¥ç”¨ user æ¥create ç¬¬ä¸‰ä¸ªblogï¼Œå¹¶ä¸”ï¼Œæ— éœ€åƒè°ƒç”¨Posté‚£æ · <code>è°ƒç”¨saveæ¥ä¿å­˜</code></li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>user.post_set.<span class="built_in">all</span>()</span><br><span class="line">&lt;QuerySet [&lt;Post: blog <span class="number">1</span>&gt;, &lt;Post: Blog <span class="number">2</span>&gt;]&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>user.post_set.create(title=<span class="string">&#x27;Blog 3&#x27;</span>, content=<span class="string">&#x27;Third Post Content!&#x27;</span>)</span><br><span class="line">&lt;Post: Blog <span class="number">3</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>user.post_set.<span class="built_in">all</span>()</span><br><span class="line">&lt;QuerySet [&lt;Post: blog <span class="number">1</span>&gt;, &lt;Post: Blog <span class="number">2</span>&gt;, &lt;Post: Blog <span class="number">3</span>&gt;]&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>Post.objects.<span class="built_in">all</span>()</span><br><span class="line">&lt;QuerySet [&lt;Post: blog <span class="number">1</span>&gt;, &lt;Post: Blog <span class="number">2</span>&gt;, &lt;Post: Blog <span class="number">3</span>&gt;]&gt;</span><br></pre></td></tr></table></figure>
<ol start="31">
<li>å›åˆ°viewsé‡Œæ”¹ä»£ç ï¼ŒæŠŠdummy data æ¢æˆ DBä¸­çš„Postï¼Œ ç„¶åå‚»çœ¼äº†å“ˆå“ˆå“ˆ<br>å› ä¸ºï¼Œæˆ‘ä¹‹å‰dummy data ç”¨çš„å­—æ®µæ˜¯å·¥ä½œä¸­çš„ï¼Œ å’Œtemplates é‡Œçš„ html å…¼å®¹<br>ç°åœ¨è¦å›åˆ°ï¼Œ home ä¸­ï¼ŒæŠŠ  for post in posts_parameters_key ä¸‹çš„å­—æ®µéƒ½æ¢æˆä¸Postè¡¨ä¸€è‡´çš„å†…å®¹</li>
</ol>
<p><strong>views.py</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">home</span>(<span class="params">request</span>):</span><br><span class="line">    context = &#123;</span><br><span class="line">        <span class="comment"># æŠŠ åµŒå¥—åœ¨views.pyä¸­çš„dummy data posts æ¢æˆäº†DB data Post.objects.all()</span></span><br><span class="line">        <span class="comment">#&#x27;posts_parameters_key&#x27;: posts</span></span><br><span class="line">        <span class="string">&#x27;posts_parameters_key&#x27;</span>: Post.objects.<span class="built_in">all</span>()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&#x27;multicorn/home.html&#x27;</span>, context)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ol start="31">
<li>é‡æ–°å¯åŠ¨ç½‘ç«™ï¼Œ python manage.py runserver 9999<br>![](_v_images/20201004231145556_2081382756.png =300x)</li>
</ol>
<p>31.1 </p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">small</span> <span class="attr">class</span>=<span class="string">&quot;text-muted&quot;</span>&gt;</span>&#123;&#123; post.date_posted | date:&quot;F d, Y&quot; &#125;&#125;<span class="tag">&lt;/<span class="name">small</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>![](_v_images/20201004231458499_7661096.png =200x)</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">small</span> <span class="attr">class</span>=<span class="string">&quot;text-muted&quot;</span>&gt;</span>&#123;&#123; post.date_posted &#125;&#125;<span class="tag">&lt;/<span class="name">small</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>![](_v_images/20201004231410304_1438854109.png =200x)</p>
<ol start="32">
<li> è¿›å…¥admin.py æ³¨å†ŒPostï¼Œ è¿™æ ·å°±å¯ä»¥åœ¨admin é¡µé¢çœ‹åˆ°Postçš„ blogäº†</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> Post</span><br><span class="line"></span><br><span class="line">admin.site.register(Post)</span><br></pre></td></tr></table></figure>
<p>![](_v_images/20201004233353387_2058505299.png =300x)</p>
<p>å˜æ›´ä¸€ä¸‹ blog3çš„ authorï¼Œ å›åˆ°multicorn/homeä¸­ï¼Œå‘ç°ä½œè€…å·²å˜<br>![](_v_images/20201004233623918_1337007123.png =200x)</p>
]]></content>
      <categories>
        <category>Teckknowledge</category>
      </categories>
      <tags>
        <tag>django</tag>
      </tags>
  </entry>
  <entry>
    <title>es-suse</title>
    <url>/2023/02/11/es-suse/</url>
    <content><![CDATA[<h3 id="1-hostnamectl-set-hostname-ES-suse"><a href="#1-hostnamectl-set-hostname-ES-suse" class="headerlink" title="1. hostnamectl set-hostname ES-suse"></a>1. <code>hostnamectl set-hostname ES-suse</code></h3><h3 id="2-reboot"><a href="#2-reboot" class="headerlink" title="2. reboot"></a>2. <code>reboot</code></h3><h3 id="3-change-the-network-config-to-generate-ip"><a href="#3-change-the-network-config-to-generate-ip" class="headerlink" title="3. change the network config to generate ip"></a>3. change the network config to generate ip</h3><h4 id="3-1-vi-etc-sysconfig-network-ifcfg-eth0"><a href="#3-1-vi-etc-sysconfig-network-ifcfg-eth0" class="headerlink" title="3.1 vi /etc/sysconfig/network/ifcfg-eth0"></a>3.1 <code>vi /etc/sysconfig/network/ifcfg-eth0</code></h4><h4 id="3-2-add-one-line-ZONE-public"><a href="#3-2-add-one-line-ZONE-public" class="headerlink" title="3.2 add one line ZONE=public"></a>3.2 add one line <code>ZONE=public</code></h4>  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&quot;/etc/sysconfig/network/ifcfg-eth0&quot; 3L, 46B                                                                                        3,11         </span><br><span class="line">BOOTPROTO=&#x27;dhcp&#x27;</span><br><span class="line">STARTMODE=&#x27;auto&#x27;</span><br><span class="line">ZONE=public</span><br><span class="line">~</span><br></pre></td></tr></table></figure>

<h3 id="4-zypper-update"><a href="#4-zypper-update" class="headerlink" title="4. zypper update"></a>4. <code>zypper update</code></h3><h3 id="5-zypper-install-net-tools-deprecated"><a href="#5-zypper-install-net-tools-deprecated" class="headerlink" title="5. zypper install net-tools-deprecated"></a>5. <code>zypper install net-tools-deprecated</code></h3><h3 id="6-zypper-install-cnf"><a href="#6-zypper-install-cnf" class="headerlink" title="6. zypper install cnf"></a>6. <code>zypper install cnf</code></h3><h3 id="7-cnf-yum"><a href="#7-cnf-yum" class="headerlink" title="7. cnf yum"></a>7. <code>cnf yum</code></h3>]]></content>
      <categories>
        <category>Teckknowledge</category>
      </categories>
      <tags>
        <tag>ES</tag>
      </tags>
  </entry>
  <entry>
    <title>flask</title>
    <url>/2023/02/11/flask/</url>
    <content><![CDATA[<h1 id="flask"><a href="#flask" class="headerlink" title="flask"></a>flask</h1><p>FLASK_APP=/usr/local/devcodes/powerload-web FLASK_ENV=development python3 -m flask run â€“host=10.219.61.224  â€“port=2222</p>
<p><font color=#063060 size=2>1. å‘½ä»¤è¡Œå¯åŠ¨ flaskï¼šå…ˆexport FLASK_APPæŒ‡å‘å¯åŠ¨file.pyï¼›å†flask run;<br>2. å‘½ä»¤è¡Œå¯åŠ¨debugæ¨¡å¼ï¼Œexport FLASK_DEBUG=1ï¼› æ­¤æ¨¡å¼å¯changes reloaded authmatically.<br>3. python å¯åŠ¨ flask,  if <strong>name</strong> == â€˜<strong>main</strong>â€˜ï¼Œå¯åœ¨å…¶ä¸­è®¾ç½®debugæ¨¡å¼<br><strong>4. ç”¨è£…é¥°å™¨ app.route(â€œ/â€œ)  route decorators æ¥ç®¡ç†é¡µé¢è·¯å¾„ what we type into the browsing to go to different pages.</strong></font></p>
<ol start="17">
<li>login logout, éªŒè¯æ³¨å†Œæ˜¯å¦ä½¿ç”¨å­˜åœ¨äº†çš„username æˆ–è€…emailã€‚ ç™»å½•åä¸å†æ˜¾ç¤ºlogin å’Œ æ³¨å†ŒæŒ‰é’®ï¼Œ<br>åªæ˜¾ç¤ºlogoutæŒ‰é’®ã€‚ logoutä¹‹åï¼Œä¸å¯ä»¥å†è®¿é—®accounté¡µé¢ã€‚  é¦–æ¬¡ç™»é™†ç›´æ¥å±•ç¤ºaccounté¡µé¢ï¼Œå†æ¬¡ç™»å½•ç›´æ¥å±•ç¤ºhomeé¡µé¢ã€‚</li>
</ol>
<h5 id="å…ˆåšç‚¹ç®€å•çš„"><a href="#å…ˆåšç‚¹ç®€å•çš„" class="headerlink" title="å…ˆåšç‚¹ç®€å•çš„"></a>å…ˆåšç‚¹ç®€å•çš„</h5><p><code>pip install flask</code><br><code>mkdir Flask_blog</code><br><code>touch flasklog.py</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)  </span><span class="comment"># root page</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello, World!&#x27;</span></span><br></pre></td></tr></table></figure>
<hr>
<h5 id="å¢åŠ venv"><a href="#å¢åŠ venv" class="headerlink" title="å¢åŠ venv"></a>å¢åŠ venv</h5><ol>
<li><code>export FLASK_APP=flaskblog.py</code></li>
<li>flask run</li>
</ol>
<p><strong>åªè¦åšäº†æ”¹åŠ¨ï¼Œå°±è¦restart flaskï¼Œæ‰èƒ½ç”Ÿæ•ˆ</strong><br>3. å¼€å¯debugæ¨¡å¼ï¼š <code>export FLASK_DEBUG=1</code>ï¼Œå°±å¯ä»¥å®æ—¶æ›´æ–°æ”¹åŠ¨:thoes changes reload automatically.</p>
<ol start="4">
<li>å¢åŠ   main ä¹‹åï¼Œç”¨pythonæ¥run<ol>
<li><code>python flaskblog.py</code></li>
</ol>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">&lt;!--more--&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)  </span><span class="comment"># root page, two routes are handled by the same function</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/home&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">home</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&lt;h1&gt;Hello, World!&lt;/h1&gt;&#x27;</span> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/about&#x27;</span></span>)  </span><span class="comment"># root page</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">about</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&lt;h1&gt;About Page!&lt;/h1&gt;&#x27;</span> </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<hr>
<ol start="5">
<li>åœ¨layout.htmlä¸­ï¼ŒåŒ…å«ç½‘ç«™ä¸»è¦cssæ ·å¼ï¼Œå…¶ä¸­ï¼Œbodyä¸­æ·»åŠ  blockæ¨¡å—ï¼Œå¯ä»¥ç”¨æ¥è®©<br>the block section that the child templates can override. è°ƒç”¨å®ƒçš„å…¶ä»–htmlå¯ä»¥é‡å†™è¦†ç›–ã€‚</li>
</ol>
<ol start="6">
<li>mkdir static æ¥å­˜æ”¾ cssæ ·å¼ï¼Œ main.css</li>
<li>ä» snippetsä¸­å¤åˆ¶è¿‡æ¥çš„navigation.htmlæ ·å¼ï¼Œæ”¾åœ¨äº†bodyæ ‡ç­¾é‡Œé¢ï¼›<br><code>https://github.com/CoreyMSchafer/code_snippets/blob/master/Python/Flask_Blog/snippets/navigation.html</code></li>
<li>æ·»åŠ main.html åˆ°layout.htmlçš„ bodyä¸­ headä¸‹é¢ï¼š</li>
<li>åœ¨layout.htmlçš„headä¸­ï¼Œtitleå‰é¢ï¼Œæ·»åŠ linkï¼Œæ¥å¼•ç”¨staticä¸­çš„cssæ ·å¼<ol>
<li>æ³¨æ„ flaskblog.py ä¸­ import ulr_for: <code>from flask import Flask, render_template, url_for</code></li>
<li>æ”¹å†™layout.htmlï¼Œå¢åŠ å¦‚ä¸‹ï¼š<br><code>&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;&#123;&#123; url_for('static', filename='main.css') &#125;&#125;&quot;&gt;</code></li>
</ol>
</li>
</ol>
<hr>
<ol start="10">
<li>å®‰è£…flask-wtfï¼š <code>pip install flask-wtf</code></li>
</ol>
<ol start="11">
<li><p>register.htmlä¸­ å„ç§div ä¹‹å†…çš„ form.username/password/confirm_passwordéƒ½æ¥è‡ªäº forms.pyä¸­ class ä¸­å®šä¹‰çš„å˜é‡åå­—</p>
</li>
<li><p>ä½†æ˜¯æœ€åä¸€ä¸ªdivä¸­ï¼Œ æŒ‡çš„æ˜¯flaskblog.pyä¸­çš„fun name:<br>@app.route(â€˜/loginâ€™)<br>def <font color=#FF0000>login():</font></p>
</li>
</ol>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;border-top pt-3&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">small</span> <span class="attr">class</span>=<span class="string">&quot;text-muted&quot;</span>&gt;</span></span><br><span class="line">        Already Have An Account? <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;ml-2&quot;</span>  <span class="attr">href</span>=<span class="string">&quot;&#123;&#123; url_for(&#x27;login&#x27;) &#125;&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">small</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ol start="13">
<li>flash :  redirect  â€” flasklog.py<br>åœ¨registerä¸­ï¼Œæ·»åŠ ï¼Œå¦‚æœsubmitéªŒè¯æˆåŠŸï¼Œå°±è¿”å›åˆ°home page ï¼Œè¿™ä¸ªhomeï¼Œ<br>è°ƒç”¨çš„æ˜¯ flasklog.pyä¸­çš„ home fun<br>flash message æ˜¯ä¸€æ¬¡æ€§çš„ï¼Œå½“å†æ¬¡åˆ·æ–°æ—¶ï¼Œå› ä¸ºæœªè§¦å‘åˆ°é‚£ä¸ªæ¡ä»¶ï¼Œæ‰€ä»¥flash messageä¸å†å‡ºç°ï¼Œé™¤éå†æ¬¡æ³¨å†Œã€‚</li>
</ol>
<p>åŠ å…¥flash å’Œ redirect æ¥æ§åˆ¶ï¼Œåšäº†æ³¨å†Œä¹‹åï¼Œé¡µé¢çš„åˆ·æ–°è·³è½¬ï¼›</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)  </span><span class="comment"># root page, two routes are handled by the same function</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/home&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">home</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;home.html&#x27;</span>, posts=posts)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/about&#x27;</span></span>)  </span><span class="comment"># root page</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">about</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;about.html&#x27;</span>, title=<span class="string">&#x27;About&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/register&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)  </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">register</span>():</span><br><span class="line">    form = RegistrationForm()</span><br><span class="line">    <span class="keyword">if</span> form.validate_on_submit():</span><br><span class="line">        flash(<span class="string">f&#x27;Account created for <span class="subst">&#123;form.username.data&#125;</span>!&#x27;</span>, <span class="string">&#x27;success&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;home&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;register.html&#x27;</span>, title=<span class="string">&#x27;Register&#x27;</span>, form=form)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>13.2  ä½†æ˜¯å½“register å¤±è´¥åï¼Œå¹¶æ— feedback æ¥å‘Šè¯‰ç”¨æˆ·  why it was invalid</p>
<p>æ·»åŠ äº†ä¸€äº›éªŒè¯åœ¨ register.htmlï¼Œ ç”¨çš„æ˜¯å¦‚æœæ‹¿åˆ°errorä¿¡æ¯å°±å±•ç¤ºå‡ºæ¥</p>
<p>![](_v_images/20201019234332261_1025641223.png =300x)</p>
<ol start="14">
<li>åœ¨login åŠ äº† flashä¿¡æ¯ ï¼Œhardcodeå†™äº† ç”¨æˆ·åå’Œå¯†ç <br>![](_v_images/20201020002527262_100800492.png =300x)</li>
</ol>
<hr>
<ol start="15">
<li><code>pip install flask-sqlalchemy</code></li>
</ol>
<p><del>export  PIP_DEFAULT_TIMEOUT=100</del>  æ— æ•ˆ<br>sudo pip install â€“default-timeout=100 future<br>pip install â€“default-timeout=220 future<br>å› ä¸ºsudo è°ƒç”¨çš„pip æ˜¯3.6</p>
<p>![](_v_images/20201021220751159_1841048205.png =600x)</p>
<p>python</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flaskblog <span class="keyword">import</span> db</span><br><span class="line">db.create_all()    ---&gt; site.db file</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flaskblog <span class="keyword">import</span> User, Post</span><br><span class="line">user_1 = User(username=<span class="string">&#x27;Corey&#x27;</span>, email=<span class="string">&#x27;C@demo.com&#x27;</span>, password=<span class="string">&#x27;password&#x27;</span>)</span><br><span class="line"></span><br><span class="line">db.session.add(user_1)</span><br><span class="line">user_2 = User(username=<span class="string">&#x27;johnDone&#x27;</span>, email=<span class="string">&#x27;jd@demo.com&#x27;</span>, password=<span class="string">&#x27;password&#x27;</span>)</span><br><span class="line"></span><br><span class="line">db.session.add(user_2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">db.session.commit()</span><br><span class="line"></span><br><span class="line">User.query.<span class="built_in">all</span>()</span><br><span class="line"></span><br><span class="line">User.query.first()</span><br><span class="line"></span><br><span class="line">User.query.filter_by(username=<span class="string">&#x27;Corey&#x27;</span>).<span class="built_in">all</span>()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">User.query.filter_by(username=<span class="string">&#x27;Corey&#x27;</span>).first()</span><br><span class="line"></span><br><span class="line">user = User.query.filter_by(username=<span class="string">&#x27;Corey&#x27;</span>).first()</span><br><span class="line"></span><br><span class="line">user.<span class="built_in">id</span></span><br><span class="line">user = User.query.get(<span class="number">1</span>)</span><br><span class="line">user</span><br><span class="line"></span><br><span class="line">user.posts</span><br><span class="line"></span><br><span class="line">post_1 = Post(title=<span class="string">&#x27;Blog 1 &#x27;</span>, content = <span class="string">&#x27;first post content!&#x27;</span>, user_id = user.<span class="built_in">id</span>)</span><br><span class="line"></span><br><span class="line">post_2 = Post(title=<span class="string">&#x27;Blog 2 &#x27;</span>, content = <span class="string">&#x27;Second post content!&#x27;</span>, user_id = user.<span class="built_in">id</span>)</span><br><span class="line"></span><br><span class="line">db.session.add(post_1)</span><br><span class="line"></span><br><span class="line">db.session.add(post_2)</span><br><span class="line"></span><br><span class="line">db.session.commit()</span><br><span class="line"></span><br><span class="line">user.posts</span><br><span class="line"><span class="keyword">for</span> post <span class="keyword">in</span> user.posts:</span><br><span class="line">    <span class="built_in">print</span>(post.title)</span><br><span class="line"></span><br><span class="line">post = Post.query.first()</span><br><span class="line"></span><br><span class="line">post.user_id</span><br><span class="line">post.author</span><br><span class="line"></span><br><span class="line">db.drop_all()</span><br><span class="line">db.create_all()</span><br><span class="line">User.query.<span class="built_in">all</span>()</span><br><span class="line">Post.query.<span class="built_in">all</span>()</span><br></pre></td></tr></table></figure>


<hr>
<ol start="16">
<li><code>pip install flask-bcrypt</code><br>ç”¨bcrypt æ¥ç”Ÿæˆhash åŠ å¯†ï¼Œæ¯æ¬¡ç”Ÿæˆéƒ½ä¸ä¸€æ ·ï¼Œ<br>ä½†æ˜¯åä¹‹checkå´å¯ä»¥éªŒè¯çœŸä¼ªã€‚<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">~ ğŸ”¥Â» python                      vivi@vivideMacBook-Pro</span><br><span class="line">Python <span class="number">3.8</span><span class="number">.5</span> (v3<span class="number">.8</span><span class="number">.5</span>:580fbb018f, Jul <span class="number">20</span> <span class="number">2020</span>, <span class="number">12</span>:<span class="number">11</span>:<span class="number">27</span>)</span><br><span class="line">[Clang <span class="number">6.0</span> (clang-<span class="number">600.0</span><span class="number">.57</span>)] on darwin</span><br><span class="line"><span class="type">Type</span> <span class="string">&quot;help&quot;</span>, <span class="string">&quot;copyright&quot;</span>, <span class="string">&quot;credits&quot;</span> <span class="keyword">or</span> <span class="string">&quot;license&quot;</span> <span class="keyword">for</span> more information.</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> flask_bcrypt <span class="keyword">import</span> Bcrypt</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>bcrypt = Bcrypt()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>bcrypt.generate_password_hash(<span class="string">&#x27;testing&#x27;</span>)</span><br><span class="line"><span class="string">b&#x27;$2b$12$mwleE8U2426VUFW1ZfjI0OsrWatmzYla/hCHhiH5t/xsLxQl/ob6i&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>bcrypt.generate_password_hash(<span class="string">&#x27;testing&#x27;</span>).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;$2b$12$6kcDKHgJJDhlwaZZV9l0f.DPEqxcJFx01axApkdAVm/v5uoiQKyHe&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>bcrypt.generate_password_hash(<span class="string">&#x27;testing&#x27;</span>).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;$2b$12$8LMjQhBOdUqT.ZLF08SreOf7CrOYCtgOaEEXHal5okuXclqgviR1e&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>hashed_pw = bcrypt.generate_password_hash(<span class="string">&#x27;testing&#x27;</span>).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>bcrypt.check_password_hash(hashed_pw,<span class="string">&quot;password&quot;</span>)</span><br><span class="line"><span class="literal">False</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>bcrypt.check_password_hash(hashed_pw,<span class="string">&quot;testing&quot;</span>)</span><br><span class="line"><span class="literal">True</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure></li>
</ol>
<p>æ·»åŠ äº†ä¸€äº›æ ¡éªŒä¹‹åï¼Œåœ¨é¦–é¡µæ³¨å†ŒæˆåŠŸ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">~/Desktop/Flask_Blog ğŸ”¥Â» python   vivi@vivideMacBook-Pro</span><br><span class="line">Python <span class="number">3.8</span><span class="number">.5</span> (v3<span class="number">.8</span><span class="number">.5</span>:580fbb018f, Jul <span class="number">20</span> <span class="number">2020</span>, <span class="number">12</span>:<span class="number">11</span>:<span class="number">27</span>)</span><br><span class="line">[Clang <span class="number">6.0</span> (clang-<span class="number">600.0</span><span class="number">.57</span>)] on darwin</span><br><span class="line"><span class="type">Type</span> <span class="string">&quot;help&quot;</span>, <span class="string">&quot;copyright&quot;</span>, <span class="string">&quot;credits&quot;</span> <span class="keyword">or</span> <span class="string">&quot;license&quot;</span> <span class="keyword">for</span> more information.</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> flaskblog <span class="keyword">import</span> db</span><br><span class="line">/Library/Frameworks/Python.framework/Versions/<span class="number">3.8</span>/lib/python3<span class="number">.8</span>/site-packages/flask_sqlalchemy/__init__.py:<span class="number">833</span>: FSADeprecationWarning: SQLALCHEMY_TRACK_MODIFICATIONS adds significant overhead <span class="keyword">and</span> will be disabled by default <span class="keyword">in</span> the future.  <span class="type">Set</span> it to <span class="literal">True</span> <span class="keyword">or</span> <span class="literal">False</span> to suppress this warning.</span><br><span class="line">  warnings.warn(FSADeprecationWarning(</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> flaskblog.models <span class="keyword">import</span> User</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>user = User.query.first()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>user</span><br><span class="line">User(<span class="string">&#x27;ali1&#x27;</span>, <span class="string">&#x27;ali1@flask.com&#x27;</span>, <span class="string">&#x27;default.jpg&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>user.password</span><br><span class="line"><span class="string">&#x27;$2b$12$JM7NPMUz6329UQmMtj8p7uDFWtKRHmpQujnffwW0U/W1WNOfWHThG&#x27;</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>

<p> ç”¨å·²ç»å­˜åœ¨çš„ç”¨æˆ·æ¥æ³¨å†Œï¼Œé¡µé¢æŠ¥é”™</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">sqlalchemy.exc.IntegrityError</span><br><span class="line">sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: user.email</span><br><span class="line">[SQL: INSERT INTO user (username, email, image_file, password) VALUES (?, ?, ?, ?)]</span><br><span class="line">[parameters: (<span class="string">&#x27;ali1&#x27;</span>, <span class="string">&#x27;ali1@flask.com&#x27;</span>, <span class="string">&#x27;default.jpg&#x27;</span>, <span class="string">&#x27;$2b$12$HjaXxkdNbmjhLSLTu7CSsO9Nx/HLJG8.1cUrBL9TwS79/Zui9wvSm&#x27;</span>)]</span><br><span class="line">(Background on this error at: http://sqlalche.me/e/<span class="number">13</span>/gkpj)</span><br></pre></td></tr></table></figure>


<p>åœ¨æµè§ˆå™¨é¡µé¢ï¼Œåˆ°æŸä¸ªåœ°æ–¹æƒ³æ‰§è¡Œï¼Œè¾“å…¥pinç å³å¯è°ƒç”¨pythonç”Ÿæˆå„ç§ä¿¡æ¯<br>æ‰€ä»¥ï¼Œä¸å¯ä»¥ç”Ÿäº§ç¯å¢ƒä½¿ç”¨debugæ¨¡å¼ï¼Œæš´éœ²çš„ä¿¡æ¯å¤ªå¤šã€‚<br>![](_v_images/20201022210758556_1552795459.png =500x)![](_v_images/20201022210936423_1612001069.png =500x)</p>
<p>æ·»åŠ äº†ä¸€äº›éªŒè¯ä¹‹åï¼š<br>![](_v_images/20201022212003059_248276131.png =500x)</p>
<ol start="17">
<li><code>pip install flask-login</code>  å®‰è£…login æ¨¡å—</li>
</ol>
<hr>
<p>User Account and Profile Picture</p>
]]></content>
      <categories>
        <category>Teckknowledge</category>
      </categories>
      <tags>
        <tag>flask</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/2023/02/11/hello-world/</url>
    <content><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>
]]></content>
  </entry>
  <entry>
    <title>metadata</title>
    <url>/2023/02/11/metadata/</url>
    <content><![CDATA[<h4 id="ask-Pytest-to-automatically-provision-the-environment"><a href="#ask-Pytest-to-automatically-provision-the-environment" class="headerlink" title="ask Pytest to automatically provision the environment"></a>ask Pytest to automatically provision the environment</h4><p><code>pytest --provision</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ali1@remotedev-ali1-rdu:~$ pytest --provision</span><br><span class="line">logdir &#x27;log/helix&#x27; does not exist; fallback to &#x27;/ifs/home/ali1/.cache/helix/log&#x27;</span><br><span class="line">============================================================================== test session starts ===============================================================================</span><br><span class="line">platform linux -- Python 3.6.9, pytest-6.2.4, py-1.10.0, pluggy-0.13.1</span><br><span class="line">rootdir: /ifs/home/ali1</span><br><span class="line">plugins: timeout-1.4.2, helix-3.0.25, isilon-marks-0.3.3, isilon-accountant-0.4.2</span><br><span class="line">collected 0 items / 1 error</span><br><span class="line">Password:</span><br><span class="line">[2022-12-14 11:11:32.605863+00:00] QUEUED_FOR_ALLOCATION... waiting 30 seconds</span><br><span class="line">[2022-12-14 11:12:02.887701+00:00] QUEUED_FOR_ALLOCATION... waiting 30 seconds</span><br><span class="line">[2022-12-14 11:12:33.175448+00:00] READY</span><br><span class="line">[2022-12-14 11:12:33.499574+00:00] QUEUED_FOR_DELETION... waiting 30 seconds</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Teckknowledge</category>
      </categories>
      <tags>
        <tag>metadata</tag>
      </tags>
  </entry>
  <entry>
    <title>trytheauto.md</title>
    <url>/2023/02/11/trytheauto-md/</url>
    <content><![CDATA[<h4 id="using-gh-pages"><a href="#using-gh-pages" class="headerlink" title="using gh-pages"></a>using gh-pages</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = <span class="number">1</span></span><br><span class="line">b = <span class="number">2</span></span><br><span class="line">c = a+b</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>test</tag>
      </tags>
  </entry>
</search>
